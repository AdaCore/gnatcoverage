../support/src/ppc-elf/c_io.c:
53% of 28 lines covered
   1 .: static void outb(int port, unsigned char v)
   2 .: {
   3 +:   *((volatile unsigned char *)(0x80000000 + port)) = v;
   4 +: }
   5 .: 
   6 .: static unsigned char inb(int port)
   7 .: {
   8 -:   return *((volatile unsigned char *)(0x80000000 + port));
   9 -: }
  10 .: 
  11 .: void abort (void)
  12 +: {
  13 !:   outb (0x92, 0x01);
  14 .:   while (1)
  15 .:     ;
  16 .: }
  17 .: 
  18 .: int putchar(int c)
  19 +: {
  20 +:   outb (0x3f8 + 0x00, c);
  21 .:   return c;
  22 +: }
  23 .: 
  24 .: int checkkey (void)
  25 -: {
  26 -:   return inb (0x3f8 + 0x05) & 0x01;
  27 -: }
  28 .: 
  29 .: int getchar (void)
  30 -: {
  31 -:   while (!checkkey ())
  32 .:     ;
  33 -:   return inb(0x3f8 + 0x00);
  34 -: }
  35 .: 
  36 .: static void memcpy (unsigned char *d, unsigned char *s, int len)
  37 .: {
  38 *:   while (len--)
  39 +:     *d++ = *s++;
  40 .: }
  41 .: 
  42 .: static void bzero (unsigned char *d, int len)
  43 .: {
  44 !:   while (len--)
  45 -:     *d++ = 0;
  46 .: }
  47 .: 
  48 .: extern char __sdata2_load[], __sdata2_start[], __sdata2_end[];
  49 .: extern char __data_load[], __data_start[], __data_end[];
  50 .: extern char __sbss2_start[], __sbss2_end[];
  51 .: extern char __sbss_start[], __sbss_end[];
  52 .: extern char __bss_start[], __bss_end[];
  53 .: 
  54 .: void cmain (void)
  55 +: {
  56 +:   memcpy (__sdata2_start, __sdata2_load, __sdata2_end - __sdata2_start);
  57 +:   memcpy (__data_start, __data_load, __data_end - __data_start);
  58 +:   bzero (__sbss2_start, __sbss2_end - __sbss2_start);
  59 +:   bzero (__sbss_start, __sbss_end - __sbss_start);
  60 +:   bzero (__bss_start, __bss_end - __bss_start);
  61 +:   main();
  62 +:   abort ();
  63 .: }
